<!DOCTYPE html>
<html lang="fr">
    <head>
      <meta charset="UTF-8">
      <title>WBSRV Super Calculator</title>
    </head>
    <body>
            <h1>WEBSERV SUPER CALCULATOR</h1>
            <form id="calcForm" action="cgi-bin/maths.php" method="post">
                <label for="number1">Nombre 1:</label>
                <input type="number" id="number1" name="number1" required>

                <label for="number2">Nombre 2:</label>
                <input type="number" id="number2" name="number2" required>
                <button type="submit">Compute</button>
            </form>
            <pre id="result">No result yet</pre>
       <p> <img src="img/fxUC.gif" alt="MINDBLOOOOOOWN" /></p>
    <script>
        form = document.getElementById('calcForm');
        result = document.getElementById('result');

        form.addEventListener('submit', async (event) => {
            event.preventDefault(); // Empêche le rechargement de la page

            // Récupère les données du formulaire
            formData = new FormData(form);
            params = new URLSearchParams();

            // Encode les données en format "key=value"
            for ([key, value] of formData.entries()) {
                params.append(key, value);
            }

            try {
                    response = await fetch(form.action, {
                    method: form.method,
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params.toString() // Format URL-encoded
                });

                if (!response.ok) {
                    throw new Error(`Erreur serveur : ${response.status} ${response.statusText}`);
                }

                text = await response.text();
                result.textContent = text;
            } catch (error) {
                result.textContent = 'Une erreur est survenue lors de la requête : ' + error.message;
            }
        });
    </script>
    </body>
</html>
